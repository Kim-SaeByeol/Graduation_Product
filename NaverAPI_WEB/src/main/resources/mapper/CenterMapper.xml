<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kopo.poly.mapper.ICenterMapper">

    <!-- 센터 리스트 쿼리 -->
    <select id="getCenterList" resultType="CenterDTO">
        SELECT SEQ, REGION, CENTER_NAME, ADDRESS, PHONE, X, Y
        FROM Center
        ORDER BY SEQ ASC;
    </select>

    <!-- 센터 등록 쿼리 -->
    <insert id="insertCenterInfo" parameterType="CenterDTO">
        <selectKey keyProperty="seq" resultType="int" order="BEFORE">
            SELECT COALESCE(MAX(seq), 0) + 1 FROM Center
        </selectKey>
        INSERT INTO Center
        (
        SEQ, REGION, CENTER_NAME, ADDRESS, PHONE, X, Y
        )
        VALUES (
        #{seq}, #{region}, #{centerName}, #{address}, #{phone}, #{xAddress}, #{yAddress}
        )
    </insert>

    <!-- 센터 상세보기 쿼리 -->
    <select id="getCenterInfo" resultType="CenterDTO">
        SELECT SEQ, REGION, CENTER_NAME, ADDRESS, PHONE
        FROM Center
        WHERE seq = #{seq};
    </select>

    <!-- 센터 수정 쿼리 -->
    <update id="updateCenterInfo" parameterType="CenterDTO">
        UPDATE Center
        SET REGION = #{region},
            CENTER_NAME = #{centerName},
            ADDRESS = #{address},
            PHONE = #{phone}
        WHERE seq = #{seq};
    </update>

    <!-- 센터 삭제 쿼리 -->
    <delete id="deleteCenterInfo" parameterType="CenterDTO">
        DELETE FROM Center
        WHERE SEQ = #{seq};
    </delete>

    <!-- 도시와 주소로 센터 검색 쿼리 -->
    <select id="searchCenter_all" parameterType="map" resultType="CenterDTO">
        SELECT SEQ, REGION, CENTER_NAME, ADDRESS, PHONE, X, Y
        FROM Center
        WHERE (REGION = #{isSido})
          AND (ADDRESS LIKE CONCAT('%', #{centerAddress}, '%'))
        ORDER BY REGION, CENTER_NAME DESC
    </select>

    <!-- 도시로 센터 검색 쿼리 -->
    <select id="searchCenter_sido" parameterType="String" resultType="CenterDTO">
        SELECT SEQ, REGION, CENTER_NAME, ADDRESS, PHONE, X, Y
        FROM Center
        WHERE REGION = #{isSido}
        ORDER BY REGION, CENTER_NAME DESC
    </select>

    <!-- 주소로 센터 검색 쿼리 -->
    <select id="searchCenter_address" parameterType="String" resultType="CenterDTO">
        SELECT SEQ, REGION, CENTER_NAME, ADDRESS, PHONE, X, Y
        FROM Center
        WHERE ADDRESS LIKE CONCAT('%', #{centerAddress}, '%')
        ORDER BY REGION, CENTER_NAME DESC
    </select>


</mapper>